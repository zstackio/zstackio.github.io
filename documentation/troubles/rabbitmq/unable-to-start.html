<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shorcut icon" href="/image/zstack_text_icon_32x32.png">
    <link rel="icon" href="/images/zstack_text_icon_32x32.gif" type="image/gif">
    <meta name="description" content="ZStack : ZStack is open source IaaS software managing resources of compute, storage, networking throughout a datacenter all by APIs.">
    <meta name="keywords" content="ZStack, OpenStack, CloudStack, IaaS, Docker, Open Source">

    <title>ZStack - Documentation</title>
    <script type="text/javascript" src="/js/google_analytics.js"></script>
    <link href="/css/bootstrap-3.3.1/css/bootstrap.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/code.css" rel="stylesheet">
    <link href="/css/zstack.css?v=1.1" rel="stylesheet">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:url" content="http://zstack.org/" />
    <meta name="twitter:title" content="ZStack" />
    <meta name="twitter:description" content="ZStack is open source IaaS software managing resources of compute, storage, networking throughout a datacenter all by APIs." />
    <meta name="twitter:site" content="@zstack_org" />

    <!-- Facebook -->
    <meta property="og:side_name" content="ZStack" />
    <meta property="og:title" content="ZStack" />
    <meta property="og:url" content="http://zstack.org/" />
    <meta property="og:description" content="ZStack is open source IaaS software managing resources of compute, storage, networking throughout a datacenter all by APIs." />

</head>

<script src="/js/jquery-1.9.1.js"></script>
<script src="/css/bootstrap-3.3.1/js/bootstrap.js"></script>

<script type="text/javascript">
  $(document).ready(function(){
    var path = window.location.pathname;
    if (path == '/') {
      $('#navHome').addClass('active');
      return;
    }

    var paths = path.split("/");
    var root = paths[1];
    switch(root){
      case 'installation':
        $('#navInstallation').addClass('active');
        break;
      case 'tutorials':
        $('#navTutorials').addClass('active');
        break;
      case 'documentation':
        $('#navDocumentation').addClass('active');
        break;
      case 'community':
        $('#navCommunity').addClass('active');
        break;
      case 'issues':
        $('#navIssues').addClass('active');
        break;
      case 'license':
        $('#navLicense').addClass('active');
        break;
      case 'blog':
        $('#navBlog').addClass('active');
        break;
    }
  });
</script>

<body>
<nav id="header" class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">ZStack</a>
        </div>

        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li id="navHome"><a href="/">Home</a></li>
                <li id="navInstallation">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Installation <span class="caret"></span></a>
                  <ul class="dropdown-menu" role="menu">
                    <li><a href="/installation/">Quick Installation</a></li>
                    <li><a href="/installation/manual.html">Manual Installation</a></li>
                    <li><a href="/installation/multi-node.html">Multi-node Installation</a></li>
                  </ul>
                </li>
                <li id="navTutorials"><a href="/tutorials">Tutorials</a></li>
                <li id="navDocumentation"><a href="/documentation">Documentation</a></li>
                <li id="navBlog"><a href="/blog">Blog</a></li>
                <li id="navCommunity"><a href="/community">Community</a></li>
                <li id="navIssues"><a href="https://github.com/zstackorg/zstack/issues">Issues</a></li>
                <li id="navIssues"><a href="/cn">中文</a></li>
            </ul>
        </div>
    </div>
</nav>


<div class="container doc big-font">
  <h2>Unable to install a RabbitMQ server</h2>

<h3>Symptom</h3>

<p>When installing RabbitMQ using <code>zstack-ctl install_rabbitmq</code> you may encounter a failure caused by
unable to start RabbitMQ server, the error message in /tmp/zstack_installation.log is like:</p>

<pre><code>TASK: [enable RabbitMQ] *******************************************************
failed: [192.168.0.199] =&gt; {"failed": true}
msg: Starting rabbitmq-server: FAILED - check /var/log/rabbitmq/startup_{log, _err}
rabbitmq-server.
</code></pre>

<p>This is most likely caused by you have changed your hostname and a previous RabbitMQ server still retains an old
hostname. RabbitMQ relies on hostname as node name, changing hostname may cause issues that you can find details
in <a href="http://www.rabbitmq.com/ec2.html">RabbitMQ in Amazon  EC2</a>(see details in section "Issues with hostname").</p>

<h3>Solution</h3>

<h4>1. Stop RabbitMQ server</h4>

<p>As the tool <code>rabbitmqctl</code> may have failed because of hostname change, you may need to stop all running RabbitMQ related
processes by Linux <code>kill</code> command with <code>-9</code> option.</p>

<div class="bs-callout bs-callout-warning">
  <h4>Make sure no RabbitMQ related processes running</h4>
  The <code>service rabbitmq-server stop</code> will mislead you that the RabbitMQ server is stopped but if you
  <code>ps -aux | grep rabbitmq</code> you will see a bunch of RabbitMQ process still running. So please use <code>ps</code>
  to check your system before proceeding.
</div>


<h4>2. Reset environment variable HOSTNAME to current hostname</h4>

<p>If you haven't logout/login shell sessions after changing the hostname, the environment variable HOSTNAME will remain
to the old one that fails <code>rabbitmqctl</code>. You can change the <code>$HOSTNAME</code> by:</p>

<pre><code>export HOSTNAME=`hostname`
</code></pre>

<p>or simply logout then login your shell</p>

<h4>3. Start RabbitMQ server</h4>

<p>Now you can start the server by:</p>

<pre><code>service rabbitmq-server start
</code></pre>

<div class="bs-callout bs-callout-info">
  <h4>The hostname may need to be routable</h4>
  
  We have seen some articles saying that the hostname must be routable otherwise RabbitMQ server won't work.
  However, in version (3.x) of RabbitMQ we don't see this issue. If you encounter it, please follow above
  <a href="http://www.rabbitmq.com/ec2.html">RabbitMQ in Amazon  EC2</a> to add IP/hostname pair in /etc/hosts file.
</div>




</div>

<div id="footer">
  <div class="container zstack-footer-before zstack-footer-after">
    <div class="row zstack-footer-links">
      <div class="col-sm-3 col-sm-offset-1">
        <p class="footer-text-title">Community</p>
        <ul class="footer-ul">
          <li><a class="footer-text-link" href="https://groups.google.com/forum/#!forum/zstack"> Mailing List</a></li>
          <li><a class="footer-text-link" href="http://www.zstack.org/community">Community</a></li>
          <li>Gitter</li>
        </ul>
      </div>
      <div class="col-sm-3">
        <p class="footer-text-title">Resources</p>
        <ul class="footer-ul">
          <li><a class="footer-text-link" href="http://www.zstack.org/installation">Intallation</a></li>
          <li><a class="footer-text-link" href="http://www.zstack.org/tutorials">Tutorials</a></li>
          <li><a class="footer-text-link" href="http://www.zstack.org/blog">Blog</a></li>
          <li><a class="footer-text-link" href="http://www.zstack.org/documentation">Documentation</a></li>
        </ul>
      </div>
      <div class="col-sm-4">
        <p class="footer-text-title">Connect Us</p>
        <ul class="footer-ul">
          <a title="Twitter" class="contact-icon contact-icon-size fa fa-twitter" href="https://twitter.com/zstack_org" target="_blank"></a>&nbsp;&nbsp;
          <a title="Facebook" class="contact-icon contact-icon-size fa fa-facebook" href="https://www.facebook.com/zstackorg" target="_blank"></a>&nbsp;&nbsp;
          <a title="Github" class="contact-icon contact-icon-size fa fa-github-alt" href="https://github.com/zstackorg/zstack" target="_blank"></a>&nbsp;&nbsp;
          <a title="Wechat" class="contact-icon contact-icon-size fa fa-weixin" href="../misc/wechat.html" target="_blank"></a>&nbsp;&nbsp;
          <a title="Weibo" class="contact-icon contact-icon-size fa fa-weibo" href="http://weibo.com/zstack" target="_blank"></a>&nbsp;&nbsp;
        </ul>
        <ul class="footer-ul zstack-footer-before2">
          <li><i>ZStack is open source IaaS software provided under the Apache 2.0 license.</i></li>
        </ul>
      </div>
    </div>
  </div>
</div>
<div class="footer-last">
  <div>
      <i><b>Your feedback is invaluable, please let us know your thoughts. &nbsp;&nbsp;<a title="Email" class="contact-icon fa fa-envelope" href="mailto:info@zstack.org"></a></b> <i>
  </div>
</div>


</body>

</html>
